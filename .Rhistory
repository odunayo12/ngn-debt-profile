library(readr)
X1538 <- read_csv("scrapper/downloads/1538.csv")
View(X1538)
library(tidyverse)
library(data.table)
install.packages('data.table')
map_df_fread <- function(path, pattern = "*.csv") {
list.files(path, pattern, full.names = TRUE) %>%
map_df(~fread(.))
}
debt_table <- map_df_fread('scrapper/downloads/')
library(data.table)
library(data.table)
debt_table <- map_df_fread('scrapper/downloads/')
View(debt_table)
path <- "scrapper/downloads/"
files <- list.files(path=path, pattern="*.csv")
for(file in files)
for(file in files){
perpos <- which(strsplit(file, "")[[1]]==".")
assign(
gsub(" ","",substr(file, 1, perpos-1)),
read.csv(paste(path,file,sep="")))
}
map_df_fread <- function(path, pattern = "*.csv") {
list.files(path, pattern, full.names = TRUE) %>%
map_df(~fread(.))%>%
mutate(source = path)
}
debt_table <- map_df_fread('scrapper/downloads/')
csv_files- fs::dir_ls('scrapper/downloads/', regexp = '\\.csv$')
csv_files <- fs::dir_ls('scrapper/downloads/', regexp = '\\.csv$')
csv_files
readr::read_csv(csv_files[1])
csv_files <- fs::dir_ls('scrapper/downloads/', regexp = '\\.csv$') %>%
map_dfr(read_csv, .id = "source")
csv_files <- fs::dir_ls('scrapper/downloads/', regexp = '\\.csv$') %>%
map_dfr(read_csv, .id = "source") %>% view()
csv_files
csv_files <- fs::dir_ls('scrapper/downloads/', regexp = '\\.csv$')
csv_files %>%
map_dfr(read_csv, .id = "source") %>% view()
files_read<- csv_files %>%
map_dfr(read_csv, .id = "source") %>% view()
files_read<- csv_files %>%
purr::map_dfr(read_csv, .id = "source") %>% view()
install.packages("purrr")
install.packages("purrr")
library(tidyverse)
files_read<- csv_files %>%
map_dfr(read_csv, .id = "source") %>% view()
files_read<- csv_files %>%
map_dfr(read_csv) %>% view()
rlang::last_error()
rlang::last_trace()
csv_files <- fs::dir_ls('scrapper/downloads/', regexp = '\\.csv$')
files_read<- csv_files %>%
map_dfr(read_csv) %>% view()
View(X1538)
files_read<- csv_files %>%
map(read_csv) %>%
bind_rows()
map_df_fread <- function(path, pattern = "*.csv") {
list.files(path, pattern, full.names = TRUE) %>%
map_df(~fread(.))%>%
mutate(.id = 'source')
}
debt_table <- map_df_fread('scrapper/downloads/')
View(debt_table)
map_df_fread <- function(path, pattern = "*.csv") {
list.files(path, pattern, full.names = TRUE) %>%
#map_df(~fread(.))%>%
map_dfr(read_csv, .id = 'source')
mutate(.id = 'source')
}
debt_table <- map_df_fread('scrapper/downloads/')
files_read<- list.files(path = 'scrapper/downloads/', pattern = '.csv$', full.names = T) %>%
map(read_csv, skip = 1, .id='source')
files_read<- list.files(path = 'scrapper/downloads/', pattern = '.csv$', full.names = T) %>%
map(read_csv, skip = 1)
files_read<- list.files(path = 'scrapper/downloads/', pattern = '.csv$', full.names = T) %>%
map(read_csv, skip = 1) %>%
view()
View(files_read)
files_read<- csv_files %>%
map(read_csv) %>%
bind_rows()
files_read<- csv_files %>%
map_dfr(read_csv) %>%
bind_rows()
View(files_read)
View(debt_table)
map2(map(csv_files, data.table::fread, sep=","), files, cbind)
csv_files <- fs::dir_ls('scrapper/downloads/', regexp = '\\.csv$') %>%
map( data.table::fread, sep=",") %>%
map2( cbind)
csv_files <- fs::dir_ls('scrapper/downloads/', regexp = '\\.csv$') %>%
map2(map(csv_files, data.table::fread, sep=","), csv_files, cbind)
csv_files <- fs::dir_ls('scrapper/downloads/', regexp = '\\.csv$') %>%
map2(map(csv_files, data.table::fread, sep=",", fill= T), csv_files, cbind)
csv_files <- fs::dir_ls('scrapper/downloads/', regexp = '\\.csv$') %>%
map2(map(csv_files, data.table::fread, sep=","), csv_files, cbind, , fill= T)
csv_files <- fs::dir_ls('scrapper/downloads/', regexp = '\\.csv$') %>%
map2(map(csv_files, data.table::fread, sep=","), csv_files, cbind)
csv_files <- fs::dir_ls('scrapper/downloads/', regexp = '\\.csv$') %>%
map2(map(csv_files, data.table::fread, sep=","), csv_files, cbind)
csv_files <- fs::dir_ls('scrapper/downloads/', regexp = '\\.csv$') %>%
map2(map(csv_files, data.table::fread, sep=","), csv_files, cbind)
csv_files <- fs::dir_ls('scrapper/downloads/', regexp = '\\.csv$') %>%
map2(map(csv_files, data.table::fread, sep=","), files, cbind)
csv_files <- fs::dir_ls('scrapper/downloads/', regexp = '\\.csv$') %>%
map2(map(csv_files, data.table::fread, sep=","), files, cbind)
csv_files <- fs::dir_ls('scrapper/downloads/', regexp = '\\.csv$') #%>%
map2(map(csv_files, data.table::fread, sep=","), csv_files, cbind)
map2(map(csv_files, data.table::fread, sep=","), files, cbind)
debat_data<- map2(map(csv_files, data.table::fread, sep=","), files, cbind)
View(debat_data)
debat_data<- tibble( map2(map(csv_files, data.table::fread, sep=","), files, cbind))
View(debat_data)
View(debat_data[[1]][[1]])
debat_data<- tibble( map2(map(csv_files, data.table::fread, sep=","), files, rbind))
View(debt_table)
View(debat_data)
tbl = lapply(csv_files, read_csv) %>% bind_rows()
files_r <- list.files('scrapper/downloads/', '*.csv')
tbl = lapply(files_r, read_csv) %>% bind_rows()
files_r <- list.files(path = 'scrapper/downloads/', '*.csv')
files_r
files_r <- list.files(path = 'C:/Users/rotim/OneDrive - bwedu/Web Developmnet/data-analysis/ngn-debt-profile/scrapper/downloads/', '*.csv')
tbl = lapply(files_r, read_csv) %>% bind_rows()
files_r
tbl = lapply(csv_files, read_csv) %>% bind_rows()
mutate(.id = file)
map_df_fread <- function(path, pattern = "*.csv") {
list.files(path, pattern, full.names = TRUE) %>%
map_df(~fread(.)) %>%
# map_dfr(read_csv, .id = 'source')
mutate(.id = file)
}
debt_table <- map_df_fread('scrapper/downloads/')
map_df_fread <- function(path, pattern = "*.csv") {
list.files(path, pattern, full.names = TRUE) %>%
map_df(~fread(.)) #%>%
# map_dfr(read_csv, .id = 'source')
#mutate(.id = file)
}
map_df_fread <- function(path, pattern = "*.csv") {
list.files(path, pattern, full.names = TRUE) %>%
map_df(~fread(.)) #%>%
# map_dfr(read_csv, .id = 'source')
#mutate(.id = file)
}
debt_table <- map_df_fread('scrapper/downloads/')
rm()
rbindlist_fread <- function(path, pattern = "*.csv") {
files = list.files(path, pattern, full.names = TRUE)
rbindlist(lapply(files, function(x) fread(x)))
}
rbindlist_fread('scrapper/downloads/')
rbindlist_fread <- function(path, pattern = "*.csv") {
files = list.files(path, pattern, full.names = TRUE)
rbindlist(lapply(files, function(x) fread(x)))
}
rbindlist_fread('scrapper/downloads/')
library(tidyverse)
library(data.table)
rbindlist_fread <- function(path, pattern = "*.csv") {
files = list.files(path, pattern, full.names = TRUE)
rbindlist(lapply(files, function(x) fread(x)))
}
rbindlist_fread('scrapper/downloads/')
lapply_read_csv_bind_rows <- function(path, pattern = "*.csv") {
files = list.files(path, pattern, full.names = TRUE)
lapply(files, read_csv) %>% bind_rows()
}
lapply_read_csv_bind_rows('scrapper/downloads/')
DATA_F <- lapply_read_csv_bind_rows('scrapper/downloads/')
map_df_fread <- function(path, pattern = "*.csv") {
map_df_fread <- function(path, pattern = "*.csv") {
list.files(path, pattern, full.names = TRUE) %>%
map_df(~fread(.))
}
DATA_F <- map_df_fread('scrapper/downloads/')
DATA_F <- map_df_fread('scrapper/downloads/')
map_df_fread <- function(path, pattern = "*.csv") {
list.files(path, pattern, full.names = TRUE) %>%
map_df(~fread(.))
}
""
rbindlist_fread('scrapper/downloads/')
library(tidyverse)
library(data.table)
map_df_fread <- function(path, pattern = "*.csv") {
list.files(path, pattern, full.names = TRUE) %>%
map_df(~fread(.))
}
DATA_F <- map_df_fread('scrapper/downloads/')
View(DATA_F)
list.files(path, pattern, full.names = TRUE) %>%
map_df(~fread(.; file ))
DATA_F <- map_df_fread('scrapper/downloads/')
list.files(path, pattern, full.names = TRUE) %>%
map_df(~fread(., file ))
read_plus <- function(flnm) {
read_csv(flnm) %>%
mutate(filename = flnm)
}
tbl_with_sources <-list.files('scrapper/downloads/' ,pattern = "*.csv", full.names = T) %>%
map_df(~read_plus(.))
library(tidyverse)
library(data.table)
map_df_fread <- function(path, pattern = "*.csv") {
list.files(path, pattern, full.names = TRUE) %>%
map_df(~fread(., file ))
}
DATA_F <- map_df_fread('scrapper/downloads/')
map_df_fread <- function(path, pattern = "*.csv") {
list.files(path, pattern, full.names = TRUE) %>%
map_df(~fread(., file ))
}
map_df_fread <- function(path, pattern = "*.csv") {
list.files(path, pattern, full.names = TRUE) %>%
map_df(~fread(., file ))
}
DATA_F <- map_df_fread('scrapper/downloads/')
map_df_fread <- function(path, pattern = "*.csv") {
list.files(path, pattern, full.names = TRUE) %>%
map_df(~fread(.))
}
map_df_fread <- function(path, pattern = "*.csv") {
list.files(path, pattern, full.names = TRUE) %>%
map_df(~fread(.))
}
DATA_F <- map_df_fread('scrapper/downloads/')
View(map_df_fread)
View(DATA_F)
library(tidyverse)
library(readr)
X1538 <- read_csv("scrapper/downloads/1538.csv")
View(X1538)
jun_30_16 <- X1538 %>%
select(-`Debt Category`)
View(jun_30_16)
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
filter(is.na(.))
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
filter(!is.na(.))
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
filter(!is.na(.), is.na(X4))
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
filter(!is.na(.), !is.na(X4))
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
filter(!is.na(.), !is.na(X4), str_detect("Sub"))
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
rename(debt_cat=`Amount Outstanding in
USD`, outstanding_usd = `Amount Outstanding in
NGN`, outstanding_usd = X4)
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
rename(debt_cat=`Amount Outstanding in USD`, outstanding_usd = `Amount Outstanding in NGN`, outstanding_usd = X4)
glimpse(X1538)
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
rename(debt_cat=`Amount Outstanding in\rUSD`, outstanding_usd = `Amount Outstanding in\rNGN`, outstanding_usd = X4)
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
rename(debt_cat=`Amount Outstanding in\rUSD`, outstanding_usd = `Amount Outstanding in\rNGN`, outstanding_ngn = X4)
filter(!is.na(.), !is.na(outstanding_ngn), str_detect(debt_cat, "Sub",))
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
rename(debt_cat=`Amount Outstanding in\rUSD`, outstanding_usd = `Amount Outstanding in\rNGN`, outstanding_ngn = X4) %>%
filter(!is.na(.), !is.na(outstanding_ngn), str_detect(debt_cat, "Sub",))
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
rename(debt_cat=`Amount Outstanding in\rUSD`, outstanding_usd = `Amount Outstanding in\rNGN`, outstanding_ngn = X4) %>%
filter(!is.na(.), !is.na(outstanding_ngn), str_detect(debt_cat, "Sub", negate = T))
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
rename(debt_cat=`Amount Outstanding in\rUSD`, outstanding_usd = `Amount Outstanding in\rNGN`, outstanding_ngn = X4) %>%
filter(!is.na(.), !is.na(outstanding_ngn), str_detect(debt_cat, "Sub", negate = T)) %>%
mutate(ext_rate = 283)
library(tidyverse)
View(jun_30_16)
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
rename(debt_cat=`Amount Outstanding in\rUSD`, outstanding_usd = `Amount Outstanding in\rNGN`, outstanding_ngn = X4) %>%
filter(!is.na(.), !is.na(outstanding_ngn), str_detect(debt_cat, "Sub", negate = T)) %>%
mutate(ext_rate = 283,
ext_rate = replace(
ext_rate, str_detect(ext_rate, "States*", 157)
))
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
rename(debt_cat=`Amount Outstanding in\rUSD`, outstanding_usd = `Amount Outstanding in\rNGN`, outstanding_ngn = X4) %>%
filter(!is.na(.), !is.na(outstanding_ngn), str_detect(debt_cat, "Sub", negate = T)) %>%
mutate(ext_rate = 283,
ext_rate = replace(
ext_rate, str_detect(ext_rate, "States*"), 157
))
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
rename(debt_cat=`Amount Outstanding in\rUSD`, outstanding_usd = `Amount Outstanding in\rNGN`, outstanding_ngn = X4) %>%
filter(!is.na(.), !is.na(outstanding_ngn), str_detect(debt_cat, "Sub", negate = T)) %>%
mutate(ext_rate = 283,
ext_rate = replace(
ext_rate, str_detect(debt_cat, "States*"), 157
))
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
rename(debt_cat=`Amount Outstanding in\rUSD`, outstanding_usd = `Amount Outstanding in\rNGN`, outstanding_ngn = X4) %>%
filter(!is.na(.), !is.na(outstanding_ngn), str_detect(debt_cat, "Sub", negate = T)) %>%
mutate(ext_rate = 283,
ext_rate = replace(
ext_rate, str_detect(debt_cat, "States[*]"), 157
))
library(readr)
X1539 <- read_csv("scrapper/downloads/1539.csv")
View(X1539)
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
rename(debt_cat=`Amount Outstanding in\rUSD`, outstanding_usd = `Amount Outstanding in\rNGN`, outstanding_ngn = X4) %>%
filter(!is.na(.), !is.na(outstanding_ngn), str_detect(debt_cat, "Sub", negate = T)) %>%
mutate(ext_rate = 283,
ext_rate = replace(
ext_rate, str_detect(debt_cat, "States[*]"), 157
),
remark ="*Actual Domestic Debt Stock for 36 States & the FCT was as at end-December, 2015
CBN Official Exchange rate of 1 USD to 283 NGN as at June 30, 2016 and 197 NGN as at December, 2015 were used IRO FGN and States
Domestic debt, respectively. amount in millions.")
library(readr)
X1539 <- read_csv("scrapper/downloads/1539.csv")
View(X1539)
library(tidyverse)
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
rename(debt_cat=`Amount Outstanding in\rUSD`, outstanding_usd_inM = `Amount Outstanding in\rNGN`, outstanding_ngn_inM = X4) %>%
filter(!is.na(.), !is.na(outstanding_ngn_inM), str_detect(debt_cat, "Sub", negate = T)) %>%
mutate(ext_rate = 283,
ext_rate = replace(
ext_rate, str_detect(debt_cat, "States[*]"), 197
),
remark ="*Actual Domestic Debt Stock for 36 States & the FCT was as at end-December, 2015
CBN Official Exchange rate of 1 USD to 283 NGN as at June 30, 2016 and 197 NGN as at December, 2015 were used IRO FGN and States
Domestic debt, respectively. amount in millions.")
jun_30_16 <- X1538 %>%
select(-`Debt Category`) %>%
rename(debt_cat=`Amount Outstanding in\rUSD`, outstanding_usd_inM = `Amount Outstanding in\rNGN`, outstanding_ngn_inM = X4) %>%
filter(!is.na(.), !is.na(outstanding_ngn_inM), str_detect(debt_cat, "Sub", negate = T)) %>%
mutate(ext_rate = 283,
ext_rate = replace(
ext_rate, str_detect(debt_cat, "States[*]"), 197
),
remark ="*Actual Domestic Debt Stock for 36 States & the FCT was as at end-December, 2015
CBN Official Exchange rate of 1 USD to 283 NGN as at June 30, 2016 and 197 NGN as at December, 2015 were used IRO FGN and States
Domestic debt, respectively.")
mar_31_16 <- X1539 %>%
select(-`Debt Category`) %>%
rename(debt_cat=`Amount Outstanding in\rUSD`, outstanding_usd_inM = `Amount Outstanding in\rNGN`, outstanding_ngn_inM = X4) %>%
filter(!is.na(.), !is.na(outstanding_ngn_inM), str_detect(debt_cat, "Sub", negate = T)) %>%
mutate(ext_rate = 197,
ext_rate = replace(
ext_rate, str_detect(debt_cat, "States[*]"), 168
),
remark ="*Actual Domestic Debt Stock for 36 States & the FCT was as at end-December, 2014
CBN Official Exchange rate of 1 USD to 197 NGN as at March 31, 2016 and 168 NGN as at December, 2014 were used IRO FGN and States
Domestic debt, respectively.")
View(mar_31_16)
mar_31_16 <- X1539 %>%
select(-`Debt Category`) %>%
rename(debt_cat=`Amount Outstanding in\rUSD`, outstanding_usd_inM = `Amount Outstanding in\rNGN`, outstanding_ngn_inM = X4) %>%
filter(!is.na(.), !is.na(outstanding_ngn_inM), str_detect(debt_cat, "Sub", negate = T)) %>%
mutate(ext_rate = 197,
ext_rate = replace(
ext_rate, str_detect(debt_cat, "States[*]"), 168
),
remark ="*Actual Domestic Debt Stock for 36 States & the FCT was as at end-December, 2014
CBN Official Exchange rate of 1 USD to 197 NGN as at March 31, 2016 and 168 NGN as at December, 2014 were used IRO FGN and States
Domestic debt, respectively.") %>%
mutate(check_val = ext_rate*outstanding_usd_inM)
